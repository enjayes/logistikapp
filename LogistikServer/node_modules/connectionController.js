/**
 * connectionController.
 *
 * >>Description<<
 *
 * @author Manfred
 * @date 21.11.14 - 10:25
 * @copyright munichDev UG
 */




connectionController={

    preferences:null,
    io:null,
    http:null,
    websiteController:null,
    appController:null,
    init:function(preferences,io,http,adminController,appController){
       this.preferences = preferences;

       this.io= io;
       this.http=http;
       this.adminController = adminController;
       this.appController = appController;
       //Listen on Post
        this.http.listen(this.preferences.port, function(){
            console.log("Server listening on port "+connectionController.preferences.port);
        });

        //Connected
        this.io.on('connection', function (socket) {

            //Verbindung aufgebaut, sende BestÃ¤tigung
            socket.emit('message', {t: "c"});

            //Messages des Sockets weiterreichen
            socket.on('message',  function (msg) {
                if (msg.c==0)
                    appController.messageRecieved(socket, msg);
                else if (msg.c==1){
                    adminController.messageRecieved(socket, msg);
                }
            }  );

        });

    }

}








module.exports = connectionController;